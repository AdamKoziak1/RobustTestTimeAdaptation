TODO:
  -try learnable skip connection 
  -general module for different types of denoising?

  maybe ensemble as backup

  profile runtime more precisely

  resnet18 first, then resnet50
    models other than resnet18 will need change in layer selection for cr_loss and stuff

ideas:
lp-bounded attacks could operate in low singular value space
  what if attacker knows this?
    consider stronger attacks
      (AutoAttack‑TTA and DIA; RTTDP, integrate ImageNet‑C subset)

  class prototypes
    cosine similarity to classify each feature based on mean features 



Uncovering Adversarial Risks of Test-Time Adaptation: 
"Distribution Invading Attack (DIA)" is how we're attacking
"The risk of TTA stems from its transductive learning
paradigm, where the predictions on test samples are no
longer independent of each other. In this section, we
detail how specific approaches used in TTA expose security
vulnerabilities."

"We solve the bilevel optimization problems defined in
the last section via iterative projected gradient descent,
summarized in Algorithm 1"


(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find PACS/art_painting/ -type f | wc -l
2048
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find PACS/cartoon/ -type f | wc -l
2344
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find PACS/photo/ -type f | wc -l
1670
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find PACS/sketch/ -type f | wc -l
3929

(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find VLCS/Caltech101/ -type f | wc -l
1415
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find VLCS/LabelMe/ -type f | wc -l
2656
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find VLCS/SUN09/ -type f | wc -l
3282
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find VLCS/VOC2007/ -type f | wc -l
3376

(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find office-home/Art/ -type f | wc -l
2427
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find office-home/Clipart/ -type f | wc -l
4365
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find office-home/Product/ -type f | wc -l
4439
(base) adam@SCS-GPU-2024-5:~/Downloads/RobustTestTimeAdaptation/datasets$ find office-home/RealWorld/ -type f | wc -l
4357

