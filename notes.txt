TODO:
  resnet18 first, then resnet50
    models other than resnet18 will need change in layer selection for cr_loss




  introduce learnable parameter over the local smoothing/"message passing"
  regularize on global frequency
    *check if fft is differentiable 

  minimize nuclear norm
    -use closed form solution

    convolution with affinity = gnn

  theory note on spectral filtering + BN; derive error bound

  ablation on each param (use best combination and vary only the one of interest)
    -rerun this

  separate over datasets

  look into lowrank methods. what is novel

  maybe ensemble as backup

  profile runtime more precisely


ideas:
lp-bounded attacks could operate in low singular value space
  what if attacker knows this?
    consider stronger attacks
      (AutoAttack‑TTA and DIA; RTTDP, integrate ImageNet‑C subset)


  EMV update

  class prototypes
    cosine similarity to classify each feature based on mean features 

svd variations:
/erm     185
/tent    160 185
/PL      130 185
/SHOT-IM 145 185
/T3A     150 185
/TSD     125 190
TTA3-MI 150 185
TTA3-CR 160 185


both passes are through the same model
teacher-student model